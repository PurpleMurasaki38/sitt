<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <title>Lab Nmap — http-brute (uso local)</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Arial,sans-serif;max-width:880px;margin:40px auto;padding:0 16px;line-height:1.6}
    code,pre{font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace;background:#f6f8fa;border-radius:8px}
    pre{padding:14px;overflow:auto}
    .card{border:1px solid #e5e7eb;border-radius:14px;padding:16px;margin:18px 0}
    h1,h2{line-height:1.25}
    .note{background:#fff8c5;border:1px solid #e9d300;padding:12px;border-radius:10px}
  </style>
</head>
<body>
  <h1>Laboratório Nmap — http-brute (somente no seu PC)</h1>
  <div class="note"><strong>Importante:</strong> GitHub Pages é estático e não suporta autenticação HTTP 401 (Basic/Digest/NTLM). 
  Para usar <code>http-brute</code>, rode o servidor abaixo no <strong>seu computador</strong> e aponte o Nmap para <code>localhost</code>.</div>

  <div class="card">
    <h2>1) Baixe os arquivos deste lab</h2>
    <p>Baixe/copie estes dois arquivos para uma pasta no seu computador (ex.: <code>C:\lab-http</code>):</p>
    <ul>
      <li><code>server.py</code> — servidor local com HTTP Basic Auth</li>
      <li><code>users.txt</code> e <code>passwords.txt</code> — listas para o Nmap</li>
    </ul>
  </div>

  <div class="card">
    <h2>2) Conteúdo dos arquivos</h2>

    <h3>server.py</h3>
    <p>Copie o código abaixo para um arquivo <code>server.py</code>:</p>
<pre><code>from http.server import HTTPServer, BaseHTTPRequestHandler
import base64

# Defina suas credenciais de teste
VALID_USER = "admin"
VALID_PASS = "123"

realm = "Lab-Nmap"

def is_auth_valid(header):
    if not header or not header.startswith("Basic "):
        return False
    try:
        raw = base64.b64decode(header.split(" ",1)[1]).decode("utf-8")
        user, pwd = raw.split(":", 1)
        return (user == VALID_USER and pwd == VALID_PASS)
    except Exception:
        return False

class Handler(BaseHTTPRequestHandler):
    def do_GET(self):
        auth = self.headers.get("Authorization")
        if not is_auth_valid(auth):
            self.send_response(401)
            self.send_header("WWW-Authenticate", f'Basic realm="{realm}"')
            self.end_headers()
            self.wfile.write(b"Auth required (HTTP Basic).")
            return
        self.send_response(200)
        self.end_headers()
        self.wfile.write(b"Bem-vindo! Credenciais corretas.")

    def log_message(self, fmt, *args):
        return  # silencioso

if __name__ == "__main__":
    print("Rodando em http://localhost:8080 (HTTP Basic: admin/123)")
    HTTPServer(("0.0.0.0", 8080), Handler).serve_forever()
</code></pre>

    <h3>users.txt</h3>
<pre><code>admin
user
teste
</code></pre>

    <h3>passwords.txt</h3>
<pre><code>123
admin
senha
123456
</code></pre>
  </div>

  <div class="card">
    <h2>3) Rodar o servidor local</h2>
    <p>No Windows, abra o <strong>CMD</strong> na pasta onde salvou os arquivos e execute:</p>
<pre><code>python server.py
</code></pre>
    <p>Acesse <code>http://localhost:8080</code> no navegador. Ele deve pedir usuário e senha (HTTP Basic). Use <code>admin</code> / <code>123</code>.</p>
  </div>

  <div class="card">
    <h2>4) Rodar o Nmap (http-brute)</h2>
    <p>Com o servidor rodando, execute:</p>
<pre><code>nmap --script http-brute -p 8080 localhost --script-args userdb=users.txt,passdb=passwords.txt,http-brute.path=/</code></pre>
    <p>Se tudo estiver certo, o Nmap deve encontrar as credenciais válidas (<code>admin:123</code>).</p>
  </div>

  <div class="card">
    <h2>Notas legais</h2>
    <p>Use este laboratório apenas em sistemas seus ou com permissão explícita. Rodar força bruta em terceiros é ilegal.</p>
  </div>

</body>
</html>
